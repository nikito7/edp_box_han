# edpbox1 package
# standard modbus

modbus:

  - name: edpbox1
    type: tcp         # rtuovertcp
    host: 10.1.0.200
    port: 9502
    delay: 1
    timeout: 3
    retries: 3
    retry_on_empty: true
    message_wait_milliseconds: 250

    sensors:

### ### ###

      - name: "EB7 0x0026" # Vazio Ponta Cheias
        slave: 1
        address: 38
        input_type: input
        count: 3
        data_type: custom
        structure: ">3I"
        scan_interval: 31

### ### ###

      - name: "EB7 0x0016" Import Export
        slave: 1
        address: 22
        input_type: input
        count: 2
        data_type: custom
        structure: ">2I"
        scan_interval: 32

### ### ###

      - name: "EB7 0x006C" Voltage Current
        slave: 1
        address: 108
        input_type: input
        count: 2
        data_type: custom
        structure: ">2h"
        scan_interval: 21

###

      - name: "EB7 0x0079" Power Import Export PF
        slave: 1
        address: 121
        input_type: input
        count: 3
        data_type: custom
        structure: ">2IH"
        scan_interval: 11

###
      - name: "EB7 Frequency" # 0x007F
        slave: 1
        address: 127
        input_type: input
        count: 1
        data_type: uint16
        precision: 1
        scale: 0.1
        unit_of_measurement: Hz
        scan_interval: 39

###

      - name: "EB7 0x000B" # Tariff
        slave: 1
        address: 11
        input_type: input
        count: 1
        data_type: custom
        structure: ">Bx"
        scan_interval: 43

### templates

template:
#2
  - sensor:
###4
    - name: "EB1rtu Tariff"
      state: >
        {% set x = states('sensor.eb7_0x000b')|string %}
        {% if x == "1" %}
          {{ "Vazio" }}
        {% elif x == "2" %}
          {{ "Ponta" }}
        {% elif x == "3" %}
          {{ "Cheias" }}
        {% endif %}
      icon: mdi:calendar

# EOF
